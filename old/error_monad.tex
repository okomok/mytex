\documentclass{article}
\usepackage{strd,cat,my,hask}
\usepackage[active,tightpage]{preview}


\begin{document}

\myin[preview,math,aligned]{
    & \myitem \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{e\texttt{+}a}
        \strdcellnode{u End}{\texttt{return}}
        \strduse{mid}{u}{v} \strdsidelabel{v}{}{a}
    } \mydefeq
    \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{e\texttt{+}a}
        \strdcellnode{u End}{\texttt{Right}}
        \strduse{mid}{u}{v} \strdsidelabel{v}{}{a}
    } \\ 
    & \myitem \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{e\texttt{+}b}
        \strdcellnode{u End}{\texttt{>>=}}
        \strdroad{left}{u}{v} \strdroadlabel{v}{a}{e\texttt{+}b}
        \strduse{right}{u}{w} \strdsidelabel{w End}{}{e\texttt{+}a}
        \strdcellnode{v End}{f}
        \strdyhalf{\strdmid{w}{ww}}
    } \mydefeq 
    \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{e\texttt{+}b}
        \strdbranch{u}{m} \strdcellnode{m Main End}{\Delta}
        \strdsidelabel{m Main}{}{\haskcoprod{e}{b}}
        \strdsidelabel{m Left}{}{\haskcoprod{e}{b}}
        \strdsidelabel{m Right}{}{\haskcoprod{e}{b}}
        \strdbijsqx{3}{2.2}{2.2}{u}{b} \strdsqlabel{b}{\texttt{+}}
        \strdcellnode{m Left End}{f}
        \strdcellnode{m Right End}{\texttt{Left}}
        \strdmid{m Left}{ml} \strdsidelabel{ml}{}{a}
        \strdmid{m Right}{mr} \strdsidelabel{mr}{}{e}
        \strdmid{b}{v} \strdsidelabel{v}{}{\haskcoprod{e}{a}}
    } \\ 
}


\myin[preview,math,aligned]{
    & \myitem \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{e\texttt{+}a}
        \strdcellnode{u End}{\texttt{throwError}}
        \strduse{mid}{u}{v} \strdsidelabel{v}{}{e}
    } \mydefeq
    \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{e\texttt{+}a}
        \strdcellnode{u End}{\texttt{Left}}
        \strduse{mid}{u}{v} \strdsidelabel{v}{}{e}
    } \\ 
    & \myitem \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{e\texttt{+}a}
        \strdcellnode{u End}{\texttt{catchError}}
        \strdroad{left}{u}{v} \strdroadlabel{v}{e}{e\texttt{+}a}
        \strduse{right}{u}{w} \strdsidelabel{w End}{}{e\texttt{+}a}
        \strdcellnode{v End}{h}
        \strdyhalf{\strdmid{w}{ww}}
    } \mydefeq 
    \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{e\texttt{+}a}
        \strdbranch{u}{m} \strdcellnode{m Main End}{\Delta}
        \strdsidelabel{m Main}{}{\haskcoprod{e}{a}}
        \strdsidelabel{m Left}{}{\haskcoprod{e}{a}}
        \strdsidelabel{m Right}{}{\haskcoprod{e}{a}}
        \strdbijsqx{3}{2.2}{2.2}{u}{b} \strdsqlabel{b}{\texttt{+}}
        \strdcellnode{m Left End}{\texttt{Right}}
        \strdcellnode{m Right End}{h}
        \strdmid{m Left}{ml} \strdsidelabel{ml}{}{a}
        \strdmid{m Right}{mr} \strdsidelabel{mr}{}{e}
        \strdmid{b}{v} \strdsidelabel{v}{}{\haskcoprod{e}{a}}
    } \\ 
}

\end{document}
