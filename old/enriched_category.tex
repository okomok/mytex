\documentclass[]{article}
\usepackage{strd,my}

\begin{document}

\myinn{preview}{math}{
    \strdin{gathered}{
        \strdyscale{2}{
            \strddouble{mid}{\strdorigin}{U}
            \strdstartlabel{U}{\mathcal{A}}
            \strddsidelabel{U}{A}{A'}
        }
    } \mydefeq
    \strdin{gathered}{
        \strdyscale{2}{
            \strdmid{\strdorigin}{U} 
            \strdstartlabel{U}{\mathcal{A}(A,A')}
        }
    }
}

\myinn{preview}{math}{
    \strdin{gathered}{
        \strddouble{mid}{\strdorigin}{U}
        \strddouble{left}{U}{L}
        \strddouble{right}{U}{R}
        \strdstartlabel{U}{\mathcal{A}}
    } \mydefeq
    \strdin{gathered}{
        \strdscale{2}{1.2}{
        \strdmid{\strdorigin}{U}
        \strdleft{U}{L}
        \strdright{U}{R}
        \strdstartlabel{U}{\mathcal{A}(A,C)}
        \strdendlabel{L}{\mathcal{A}(A,B)}
        \strdendlabel{R}{\mathcal{A}(B,C)}
        \strdcelllabel{U End}{M}
    }
    }
}

\myinn{preview}{math}{
    \strdin{gathered}{
        \strdyscale{2}{
        \strddoublex{mid}{\strdorigin}{U}
        \strddoubleend{U}
        \strdstartlabel{U}{\mathcal{A}}
    }
    } \mydefeq 
    \strdin{gathered}{
        \strdyscale{2}{
        \strdmid{\strdorigin}{U}
        \strdstartlabel{U}{\mathcal{A}(A,A)}
        \strdcelllabel{U End}{j}
    }
    }
}

\myinn{preview}{math}{
    \strdin{gathered}{
        \myassign{LHS}{
        \strddouble{mid}{\strdorigin}{U}
        \strddouble{left}{U}{L}
        \strddouble{left}{L}{LL}
        \strddouble{right}{L}{LR}
        \strddouble{right}{U}{R}
        \strddouble{mid}{R}{R2}
        \strdstartlabel{U}{\mathcal{A}}
    }
    } =
    \strdin{gathered}{
        \strdflip{\LHS}
    }
}
 

\myinn{preview}{math}{
    \strdin{gathered}{
        \myassign{LHS}{
        \strddouble{mid}{\strdorigin}{U}
        \strddouble{left}{U}{L}
        \strddoubleend{L}
        \strddouble{right}{U}{R}
        \strddouble{mid}{R}{R2}
        \strdstartlabel{U}{\mathcal{A}}
    } 
    } = 
    \strdin{gathered}{
        \strdyscale{2}{
            \strddoublex{mid}{\strdorigin}{U}
            \strdstartlabel{U}{\mathcal{A}}
        }
    } =
    \strdin{gathered}{
        \strdflip{\LHS}
    }
}

\myinn{preview}{math}{
    g \circ f \mydefeq
    \strdin{gathered}{
        \strddouble{mid}{\strdorigin}{U}
        \strddouble{left}{U}{L}
        \strddouble{right}{U}{R}
        \strdcelllabel{L End}{f}
        \strdcelllabel{R End}{g}
        \strdstartlabel{U}{\mathcal{A}}
    }
}
\end{document}
