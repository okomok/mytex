\documentclass{article}
\usepackage{strd,cat,my,hask}
\usepackage[active,tightpage]{preview}


\begin{document}

% self-enriched
\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{b}{a}
    } \mydefeq
    \strdgathered{
        \strdmid, \strdrlabel{a \haskop{->}b}
    } \\
}

\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{fb}{fa}
        , \strdcell{\haskop{fmap}}
        , \strdroad\strdmid, \strdroadlabel{b}{a}
    } 
}

\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{c}{a}
        , \strdbranch{
            \strdroad\strdleft, \strdroadlabel{}{b}
        }
        , \strdroad\strdright
    } \mydefeq
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{c}{a}
        , \strdcell{\haskop{.}}
        , \strdbranch{
            \strdroad\strdleft, \strdroadlabel{c}{b}
        }
        , \strdroad\strdright, \strdroadlabel{b}{a}
    }
}


\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{}{a}
        , \strddeadend
    } \mydefeq
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{a}{a}
        , \strdcell{\haskop{id}}
    } \\
}

\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{b}{a}
        , \strdbranch{
            \strdroad\strdleft, \strdroadlabel{}{a}
        }
        , \strdroad\strdright
        , \strddeadend
    } = 
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{b}{a}
    } =
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{b}{a}
        , \strdbranch{
            \strdroad\strdleft, \strddeadend 
        }
        , \strdroad\strdright, \strdroadlabel{b}{}
    }
}

% currying
\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdmid, \strdrlabel{c},
        \strdcell{f},
        \strdbranch{
            \strdleft, \strdrlabel{a}
        },
        \strdright, \strdrlabel{b}
    } \sim\
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{c}{b},
        \strdcell{f},
        \strdmid, \strdrlabel{a}
    } \\
}

% naming
\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdmid, \strdrlabel{c},
        \strdcell{f},
        \strdbranch{
            \strdimplicit\strdleft
        },
        \strdright, \strdrlabel{b}
    } \sim \
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{c}{b},
        \strdcell{f}
    } \\
}

\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{c}{a}
        , \strdbranch{
            \strdroad\strdleft, \strdroadlabel{}{b}
            , \strdcell{g}
        }
        , \strdroad\strdright, \strdcell{f}
    } =
    \strdgathered{
        \strdmid, \strdrlabel{c}
        , \strdcell{g}
        , \strdmid, \strdrlabel{b}
        , \strdcell{f}
        , \strdmid, \strdrlabel{a}
    }
}


\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdmid, \strdrlabel{c}
        , \strdcell{g}
        , \strdmid, \strdrlabel{b}
        , \strdcell{f}
        , \strdmid, \strdrlabel{a}
    } \ \sim
    \strdgathered{
        \strdroad\strdmid, \strdroadlabel{c}{a}
        , \strdbranch{
            \strdroad\strdleft, \strdroadlabel{}{b}
            , \strdcell{g}
        }
        , \strdroad\strdright
        , \strdcell{f}
    } 
}

\end{document}
