\documentclass{article}
\usepackage{strd,cat,my}
\usepackage[active,tightpage]{preview}


\begin{document}


\myin[preview,math,aligned]{
    & \text{then test} 
    \strdin[gathered]{
        \strdmid{\strdorigin}{u} \strdrightlabel{u}{a} 
        \strdthen{\strdmid}{\strdbranch}{u}{v}
        \strdleftlabel{v Prev}{b}
        \strdrightlabel{v Right}{b}
    } \\
}

\myin[preview,math,aligned]{
    & \myitem
    \strdin[gathered]{
        \strdmid{\strdorigin}{u} \strdsidelabel{u}{}{a} 
        \strdcellnode{u End}{P}
        \strdseq[\strdrightlabeled{\strdmid}{R},\strdnamed{\strdbranch}{bran},\strdleftlabeledat{\strdunbranch}{Right}{P}]{u}{v}
        \strdrightlabel{v Right}{b}
        \strdrightlabel{v Prev Left}{c}
        \strdcellnode{v Prev Prev End}{Q}
        \strdcellnode{bran}{\texttt{bran}}
        \strdleftlabel{bran Right}{bR}
    }
}

\myin[preview,math,aligned]{
    & \texttt{labeledat test}
    \strdin[gathered]{
        \strdmid{\strdorigin}{u} \strdsidelabel{u}{}{a} 
        \strdrightlabeledat{\strdbranch}{Right}{P}{u}{v}
   }
}

\myin[preview,math,aligned]{
    & \text{one test}
    \strdin[gathered]{
        \strdmid{\strdorigin}{u} \strdsidelabel{u}{}{a} 
        \strdcellnode{u End}{P}
        \strdseq[\strdbranch]{u}{v}
        \strdrightlabel{v Right}{b}
        \strdleftlabel{v Prev}{b}
    }
}


\myin[preview,math,aligned]{
    & \text{with test} \\
    & \strdin[gathered]{
        \strdseq[\strdmid,\strdlabelside{A}{B},\strdmid]{\strdorigin}{v}
        \strdrightlabel{v}{m}
    } \\
    & \strdin[gathered]{
        \strdseq[\strddot,\strdmid,\strdcell{F},\strdmid,\strddot]{\strdorigin}{v}
        %\strdrightlabel{v}{m}
        \strdrightlabel{v Prev}{mp}
        \strdrightlabel{v Prev Prev}{mpp}
        \strdrightlabel{v Prev Prev Prev}{mppp}
    %    \strdrightlabel{v Prev Prev Prev Prev}{mpppp}
        \strdrightlabel{v}{\strdprev{4}{v}}
    %    \strdrightlabel{\strdprev{4}{v}}{mpppp}
    } \\
}

\end{document}
