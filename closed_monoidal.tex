\documentclass[landscape]{article}
\usepackage{tikz,strd}

\begin{document}

\newcommand{\myf}[1]{
    \strdline{#1}{fz}
    \strdleft{fz}{fy}
    \strdright{fz}{fx}
    \strdcelllabel{fz End}{f}
    \strdlinelabel{fz}{}{Z}
    \strdlinelabel{fx}{}{X}
}

\newcommand{\mybf}[1]{
    \strdline{#1}{bfyz}
    \strdscale{2}{2}{ \strdbijection{bfyz}{bfbox} }
    \myf{bfyz}
    \strdline{fx}{bfx}
    \strdihomlabel{bfyz}{Y}{Z}
    \strdlinelabel{bfx}{}{X}
}

\newcommand{\myh}[1]{
    \strdline{#1}{hx'}
    \strdcelllabel{hx' Start}{h}
    \strdlinelabel{hx'}{}{X'}
}
    

% syntax

\strdpreview{
    \strdgathered{
        \strdline{\strdorigin}{xy}
        \strdihomlabel{xy}{X}{Y}
    }
    \strddefeq
    \strdgathered{
        \strdline{\strdorigin}{xy}
        \strdstartlabel{xy}{[X,Y]}
    }
    \iffalse
    \strddefeq
    \strdgathered{
        \strdline{\strdorigin}{xy}
        \strdstartlabel{xy}{(\mathcal{V})}
        \strdlinelabel{xy}{X}{Y}
    }
    \strddefeq
    \strdgathered{
        \strdline{\strdorigin}{xy}
        \strdstartlabel{xy}{(\mathcal{V})(X,Y)}
    }
    \fi
 }

% bijections
\strdpreview{
    \strdgathered{
        \mybf{\strdorigin}
        \strdlinelabel{fy}{}{Y}
    }
}

\strdpreview{
    \strdgathered{
        \strdassign{mygb}{
            \strdassign{myg}{
                \strdline{\strdorigin}{yz}
                \strdright{yz}{x}
                \strdcelllabel{yz End}{g}
                \strdihomlabel{yz}{Y}{Z}
                \strdlinelabel{x}{}{X}
                \strdcoord{yz Start}{yzc}
            }
            \strdreverse{\strdline{yzc}{z}}
            \strdscale{2}{2}{ \strdbijection{yzc}{bj} }
            \strdparallel{bj}{xy}
            \strdlinelabel{z}{}{Z}
            \strdlinelabel{xy Left}{}{Y}
            \strdlinelabel{xy Right}{}{X}
        }
    }
}


% units

\strdpreview{
    \strdgathered{
        \strdline{\strdorigin}{z}
        \strdlinelabel{z}{}{Z}
        \strdxscale{1}{
            \strdleft{z}{y}
            \strdright{z}{yz}
        }
        \strdlinelabel{y}{Y}{}
        \strdihomlabel{yz}{Y}{Z}
        \strdcelllabel{z End}{\epsilon}
    } 
    \strddefeq
    \strdgathered{
        \strdline{\strdorigin}{z}
        \strdlinelabel{z}{}{Z}
        \strdline{z}{yz}
        \strdihomlabel{yz}{Y}{Z}
        \strdsplitleft{yz}{y} \strdlinelabel{y}{Y}{} 
        \strdsplitright{yz}{yz2} \strdihomlabel{yz2}{Y}{Z}
        \strdscale{1}{1}{\strdbijection{z}{yzbox}}
    }
}

% lemma

\strdpreview{
    \strdgathered{
        \strdline{\strdorigin}{z'} \strdlinelabel{z'}{}{Z'}
        
        \strdleft{z'}{z}
        \strdxscale{2}{\strdright{z'}{zz'}} \strdihomlabel{zz'}{Z}{Z'}
        \strdcelllabel{z' End}{\epsilon}
        
        \strdyscale{3}{\strdline{z}{z2}} \strdlinelabel{z2}{}{Z}
        \strdline{zz'}{gz'} \strdlinelabel{gz'}{}{Z'}

        \strdleft{gz'}{gz} \strdlinelabel{gz}{}{Z}
        \strdright{gz'}{gx'} \strdlinelabel{gx'}{}{X'}
        \strdcelllabel{gz' End}{h}
        \strdscale{2}{2}{\strdbijection{zz'}}
        
        \strdline{gx'}{x'} \strdlinelabel{x'}{}{X'}
    } =
    \strdgathered{
        \strdline{\strdorigin}{gz'} \strdlinelabel{gz'}{}{Z'}
        \strdleft{gz'}{gz} \strdlinelabel{gz}{}{Z}
        \strdright{gz'}{gx'} \strdlinelabel{gx'}{}{X'}
        \strdcelllabel{gz' End}{h}
    }
}

% naturality of X

\strdpreview{
    \strdgathered{
        \mybf{\strdorigin}
        \myh{bfx}
        \strdlinelabel{fy}{}{Y}
    }
    =
    \strdgathered{
        \strdline{\strdorigin}{yz}
        \myf{yz}
        \myh{fx}
        \strdline{fy}{y2}
        \strdscale{2}{3}{\strdbijection{yz}{box}}
        \strdline{hx'}{x'}
        \strdlinelabel{x'}{}{X'}
        \strdihomlabel{yz}{Y}{Z}
        \strdlinelabel{fy End}{}{Y}
    }
}

\strdpreview{
    \strdgathered{
        \strdline{\strdorigin}{z}
        \strdlinelabel{z}{}{Z}
        \strdline{z}{yz}
        \strdihomlabel{yz}{Y}{Z}
        \strdcelllabel{yz End}{g}
        \strdright{yz}{x}
        \strdlinelabel{x}{}{X}
        \strdscale{2}{2}{\strdbijection{z}{zbox}}
        \strdparallel{zbox}{yx}
        \strdlinelabel{yx Right}{}{X}
        \strdcelllabel{yx Right End}{h}
        \strdline{yx Right}{x'}
        \strdlinelabel{x'}{}{X'}
        \strdline{yx Left}{y}
        \strdlinelabel{y Start}{}{Y}
    }
    =
    \strdgathered{
        \strdline{\strdorigin}{z}
        \strdlinelabel{z}{}{Z}
        \strdline{z}{yz}
        \strdihomlabel{yz}{Y}{Z}
        \strdcelllabel{yz End}{g}
        \strdright{yz}{x}
        \strdlinelabel{x}{}{X}
        \strdcelllabel{x End}{h}
        \strdline{x}{x'}
        \strdscale{2}{3}{\strdbijection{z}{zbox}}
        \strdlinelabel{x'}{}{X'}
        \strdparallel{zbox}{yx'}
        \strdlinelabel{yx' Left}{}{Y}
        \strdlinelabel{yx' Right}{}{X'}
    }
}


% functoriality of currying

\strdpreview{
    \strdgathered{
        \strdline{\strdorigin}{yz'}
        \strdihomlabel{yz'}{Y}{Z'}
        \strdcelllabel{yz' End}{M}
        \newcommand{\myl}{
            \strdxscale{2}{\strdleft{yz'}{yz}}
            \strdline{yz}{z}
            \strdleft{z}{y}
            \strdright{z}{x}
            \strdscale{2}{2}{\strdbijection{yz}{lbox}}
        }
        \strdidentity{
            \myl
            \strdline{x}{x2}
            \strdihomlabel{yz}{Y}{Z}
            \strdlinelabel{z}{}{Z}
            \strdlinelabel{y}{}{Y}
            \strdlinelabel{x}{}{X}
            \strdlinelabel{x2}{}{X}
            \strdcelllabel{z End}{f}
        }
        \strdflip{
            \myl
            \strdline{y}{x2}
            \strdihomlabel{yz}{Z}{Z'}
            \strdlinelabel{z}{}{Z'}
            \strdlinelabel{y}{}{X'}
            \strdlinelabel{x}{}{Z}
            \strdlinelabel{x2}{}{X'}
            \strdcelllabel{z End}{g}
        }
    }
    =
    \strdgathered{
        \strdline{\strdorigin}{yz'}
        \strdihomlabel{yz'}{Y}{Z'}
        \strdline{yz'}{z'}
        \strdlinelabel{z'}{}{Z'}
        \strdcelllabel{z' End}{g}
        \strdleft{z'}{z}
        \strdlinelabel{z}{}{Z}
        \strdleft{z}{y}
        \strdlinelabel{y}{}{Y}
        \strdright{z}{x}
        \strdlinelabel{x}{}{X}
        \strdxscale{1}{\strdright{z'}{x'}}
        \strdline{x'}{x'2}
        \strdlinelabel{x'2 Start}{}{X'}
        \strdline{x}{x2}
        \strdlinelabel{x2}{}{X}
        \strdline{x'2}{x'3}
        \strdlinelabel{x'3}{}{X'}
        \strdxscale{0.5}{\strdshiftleft{yz'}{yz's}}
        \strdscale{2.5}{3}{\strdbijection{yz's}{box}}
        \strdcelllabel{z End}{f}
    }
}


% Self-enrichment

\strdpreview{
    \strdgathered{
        \strdline{\strdorigin}{xz} \strdihomlabel{xz}{X}{Z} \strdcelllabel{xz End}{M}
        \strdleft{xz}{xy} \strdihomlabel{xy}{X}{Y}
        \strdright{xz}{yz} \strdihomlabel{yz}{Y}{Z}
    }
    \strddefeq
    \strdgathered{
        \strdline{\strdorigin}{xz} \strdihomlabel{xz}{X}{Z}
        \strdline{xz}{z} \strdlinelabel{z}{}{Z} \strdcelllabel{z End}{\epsilon}
        \strdleft{z}{y} \strdlinelabel{y}{}{Y} \strdcelllabel{y End}{\epsilon}
        \strdleft{y}{x} \strdlinelabel{x}{}{X}
        \strdright{y}{xy} \strdihomlabel{xy}{X}{Y}
        \strdline{xy}{xy2} \strdihomlabel{xy2}{X}{Y}
        \strdxscale{2}{\strdright{z}{yz}}
        \strdline{yz}{yz2} \strdihomlabel{yz2 Start}{Y}{Z}
        \strdline{yz2}{yz3} \strdihomlabel{yz3}{Y}{Z}
        \strdscale{3}{3}{\strdbijection{xz}{box}}
    }
}

\strdpreview{
    \strdgathered{
        \strdline{\strdorigin}{xx} \strdihomlabel{xx}{X}{X} \strdcelllabel{xx End}{j}
    }
    \strddefeq
    \strdgathered{
        \strdline{\strdorigin}{xx} \strdihomlabel{xx}{X}{X}
        \strdline{xx}{x} \strdlinelabel{x}{}{X} \strdcelllabel{x End}{\lambda}
        \strdleft{x}{x2} \strdlinelabel{x2}{}{X}
        \strdpathwith{dotted}{
            \strdright{x}{i} \strdlinelabel{i}{}{I}
            \strdline{i}{i2} \strdlinelabel{i2}{}{I}
        }
        \strdscale{2}{2}{\strdbijection{xx}{box}}
    }
}


% iso to underlying
\strdpreview{
    \strdgathered{
        \strdline{\strdorigin}{xx} \strdihomlabel{xx}{X}{Y}
        \strdline{xx}{x} \strdlinelabel{x}{}{Y} \strdcelllabel{x End}{f}
        \strdleft{x}{x2} \strdlinelabel{x2}{}{X}
        \strdpathwith{dotted}{
            \strdright{x}{i} \strdlinelabel{i}{}{I}
            \strdline{i}{i2} \strdlinelabel{i2}{}{I}
        }
        \strdscale{2}{2}{\strdbijection{xx}{box}}
    }
}

\end{document}
