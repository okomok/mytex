\documentclass{article}
\usepackage{strd,cat,my}
\usepackage[active,tightpage]{preview}


\begin{document}

\myin[preview,math,aligned]{
    \myitem
    \strdin[gathered]{
        \strdmid{\strdorigin}{u} \strdsidelabel{u}{}{z}
        \strdcellnode{u End}{h}
        \strdmid{u}{v} \strdsidelabel{v}{}{x\texttt{+}y}
    } =
    \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{z}
        \strdxscale{1.2}{\strduse{parallel}{u}{w}} \strdsidelabel{w Left}{}{z} \strdsidelabel{w Right}{}{z}
        \strdbijsqx{u}{b}{2}{1.5}{1.5} 
        \strdmid{b}{v} \strdsidelabel{v}{}{x\texttt{+}y}
        \strdcellnode{w Right End}{g} % \strdunfamilylabel{b Right}{}{\texttt{+}}
        \strdcellnode{w Left End}{f\strdrlap{,}}
        \strdxscale{1.2}{\strdparallel{w}{z}} \strdsidelabel{z Left}{}{x} \strdsidelabel{z Right}{}{y}
        \strdmaplabel{b Left}{[}{}
        \strdmaplabel{b Right}{}{]}
    } \iff \left\{ \begin{aligned}
    \strdin[gathered]{
        \strdmid{\strdorigin}{u} \strdsidelabel{u}{}{z}
        \strdcellnode{u End}{h}
        \strdmid{u}{v} \strdsidelabel{v}{}{x\texttt{+}y}
        \strdcellnode{v End}{\operatorname{in}} 
        \strdmid{v}{w} \strdsidelabel{w}{}{x}
    } &=
    \strdin[gathered]{
        \strdmid{\strdorigin}{u} \strdsidelabel{u}{}{z}
        \strdcellnode{u End}{f}
        \strdmid{u}{v} \strdsidelabel{v}{}{x}
    } \\ 
    \strdin[gathered]{
        \strdmid{\strdorigin}{u} \strdsidelabel{u}{}{z}
        \strdcellnode{u End}{h}
        \strdmid{u}{v} \strdsidelabel{v}{}{x\texttt{+}y}
        \strdcellnode{v End}{\operatorname{in}} 
        \strdmid{v}{w} \strdsidelabel{w}{}{y}
    } &=
    \strdin[gathered]{
        \strdmid{\strdorigin}{u} \strdsidelabel{u}{}{z}
        \strdcellnode{u End}{g}
        \strdmid{u}{v} \strdsidelabel{v}{}{y}
    } \end{aligned} \right. 
}
    
\myin[preview,math,aligned]{
    & \myitem \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{\texttt{()+}a}
        \strdcellnode{u End}{\texttt{return}}
        \strduse{mid}{u}{v} \strdsidelabel{v}{}{a}
    } \mydefeq
    \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{\texttt{()+}a}
        \strdcellnode{u End}{\texttt{Just}}
        \strduse{mid}{u}{v} \strdsidelabel{v}{}{a}
    } \\ 
    & \myitem \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{\texttt{()+}b}
        \strdbijnode{u End}{\texttt{>>=}}
        \strdroad{left}{u}{v} \strdroadlabel{v}{a}{\texttt{()+}b}
        \strduse{right}{u}{w} \strdsidelabel{w End}{}{\texttt{()+}a}
        \strdbijnode{v End}{f}
        \strdyhalf{\strdmid{w}{ww}}
    } \mydefeq 
    \strdin[gathered]{
        \strduse{mid}{\strdorigin}{u} \strdsidelabel{u}{}{\texttt{()+}b}
        \strdxscale{2}{\strduse{parallel}{u}{w}} \strdsidelabel{w Left}{}{\texttt{()+}b} \strdsidelabel{w Right}{}{\texttt{()+}b}
        \strdbijsqx{u}{b}{2}{2.7}{2.4} 
        \strdmid{b}{v} \strdsidelabel{v}{}{\texttt{()+}a}
        \strdcellnode{w Right End}{f} %\strdunfamilylabel{b Right}{}{\texttt{+}}
        \strdcellnode{w Left End}{\texttt{Nothing}\strdrlap{,}}
        \strdmid{w Right}{z} \strdsidelabel{z Right}{}{a}
        \strdmaplabel{b Left}{[}{}
        \strdmaplabel{b Right}{}{]}
    } \\ 
}

\end{document}
