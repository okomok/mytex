\documentclass{article}
\usepackage{strd,cat,my,hask}
\usepackage[active,tightpage]{preview}


\begin{document}


\myin{preview,math,aligned}{
    & \myitem
    \strdgathered{
        \strdmid, \strdrlabel{g(tb)},
        \strdmapframe{1}{1}{
            \strdmid, \strdrlabel{gb},
            \strdcell{s_b},
            \strdmid ,\strdrlabel{fb},
            \strdcell{h},
            \strdmid, \strdrlabel{a}
        }, \strdframellabel{\strdlvert{\haskop{traverse}}},
        \strdmid, \strdrlabel{ta}
    } =
    \strdgathered{
        \strdmid, \strdrlabel{g(tb)},
        \strdcell{s_{tb}},
        \strdmid, \strdrlabel{f(tb)},
        \strdmapframe{1}{1}{
            \strdmid, \strdrlabel{fb},
            \strdcell{h},
            \strdmid, \strdrlabel{a}
        }, \strdframellabel{\strdlvert{\haskop{traverse}}},
        \strdmid, \strdrlabel{ta}
    } \\
    & \myitem
    \strdgathered{
        \strdmid, \strdrlabel{1(tb)},
        \strdmapframe{1}{1}{
            \strdmid, \strdrlabel{1b},
            \strdcell{h},
            \strdmid, \strdrlabel{a}
        }, \strdframellabel{\strdlvert{\haskop{traverse}}},
        \strdmid, \strdrlabel{ta}
    } =
    \strdgathered{
        \strdmid, \strdrlabel{tb},
        \strdmapframe{1}{1}{
            \strdmid, \strdrlabel{b},
            \strdcell{h},
            \strdmid, \strdrlabel{a}
        }, \strdframellabel{\strdlvert{\haskop{fmap}}},
        \strdmid, \strdrlabel{ta}
    } \\ 
    & \myitem
    \strdgathered{
        \strdmid, \strdrlabel{f(g(tc))},
        \strdmapframe{2}{2}{
            \strdmid, \strdrlabel{f(gc)},
            \strdmapframe{1}{1}{
                \strdmid, \strdrlabel{gc},
                \strdcell{k},
                \strdmid, \strdrlabel{b}
            }, \strdframellabel{\strdlvert{\haskop{fmap}}},
            \strdmid, \strdrlabel{fb},
            \strdcell{h},
            \strdmid, \strdrlabel{a}
        }, \strdframellabel{\strdlvert{\haskop{traverse}}},
        \strdmid, \strdrlabel{ta}
    } =
    \strdgathered{
        \strdmid, \strdrlabel{f(g(tc))},
        \strdmapframe{2}{2}{
            \strdmid, \strdrlabel{g(tc)},
            \strdmapframe{1}{1}{
                \strdmid, \strdrlabel{gc},
                \strdcell{k},
                \strdmid, \strdrlabel{b}
            }, \strdframellabel{\strdlvert{\haskop{traverse}}},
            \strdmid, \strdrlabel{tb}
        }, \strdframellabel{\strdlvert{\haskop{fmap}}},
        \strdmid, \strdrlabel{f(tb)},
        \strdmapframe{1}{1}{
            \strdmid, \strdrlabel{fb},
            \strdcell{h},
            \strdmid, \strdrlabel{a}
        }, \strdframellabel{\strdlvert{\haskop{traverse}}},
        \strdmid, \strdrlabel{tb}
    } \\
}

\end{document}
