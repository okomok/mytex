\documentclass{article}
\usepackage{lambdax,amsmath,qstest}


\begin{document}

Tests...


% Bool test
\AssertTrue{\True}
\AssertFalse{\False}
\AssertFalse{\Not\True}
\AssertTrue{\Not\False}
\AssertTrue{\Bool{\iftrue}}
\AssertTrue{\Bool{\ifx\Identity\Identity}}
\AssertFalse{\Bool{\ifx\Compose\Identity}}
\AssertTrue{\Bool{\ifnum 3 < 4 }}
\AssertFalse{\Bool{\ifnum 5 < 4 }}
\AssertTrue{\Head{\Cons{\True}{\Nil}}}
\AssertTrue{\Bool{\ifnum 3 = \Head{\List{3,2,1}} }}
\AssertFalse{\Bool{\ifnum 2 = \Head{\List{3,2,1}} }}
\AssertTrue{ \BoolAnd{\Lessthan{3}{9}}{\True} }
\AssertTrue{ \BoolOr{\True}{\True} }
\AssertTrue{ \BoolAnd{\Lessthan{3}{9}}{\True} }
\AssertTrue{ \All{\Lessthan{3}}{\List{4,5,6}} }
\AssertTrue{\Null{\Nil}}
\AssertFalse{\Null{\List{1,2}}}


% \edef\myfun{\Fun{#1b}}
% \begin{qstest}{test Fun}{}
%     \Expect*{\myfun{a}}{ab}
%     % \Fun{#1{b}}{\Fun{#1 c}} = b c
%     % \Fun{\Fun{#1 ##1 c}}{a}{b} = a b c
% \end{qstest}


\begin{qstest}{Unlist}{}
    \Expect*{\Unlist{\List{1,2,3}}}{1,2,3}
    \Expect*{\Unlist{\List{1,2 , 3}}}{1,2 , 3}
    \Expect*{\Unlist{\List{1,2,{,}3}}}{1,2,{,}3}
\end{qstest}


\begin{qstest}{Take}{}
    \Expect*{\Unlist{\Take{3}{\List{1,2,3,4}}}}{1,2,3}
    \Expect*{\Unlist{\Take{0}{\List{1,2,3,4}}}}{}
\end{qstest}


\begin{qstest}{Drop}{}
    \Expect*{\Unlist{\Drop{2}{\List{1,2,3,4}}}}{3,4}
    \Expect*{\Unlist{\Drop{0}{\List{1,2,3,4}}}}{1,2,3,4}
    \Expect*{\Unlist{\Drop{7}{\List{1,2,3,4}}}}{}
\end{qstest}


\newcommand*{\appendb}[1]{#1b}
\begin{qstest}{Iterate}{}
    \Expect*{\Unlist{\Take{4}{\Iterate{\appendb}{a}}}}{a,ab,abb,abbb}
\end{qstest}

Iterate Test: \Unlist{\Take{4}{\Iterate{\Fun{#1b}}{a}}} = a,ab,abb,abbb


\begin{qstest}{TakeWhile}{}
    \Expect*{\Unlist{\TakeWhile{\Lessthan{3}}{\List{5,6,4,2,5,3,4}}}}{5,6,4}
\end{qstest}


\begin{qstest}{DropWhile}{}
    \Expect*{\Unlist{\DropWhile{\Lessthan{3}}{\List{5,6,4,2,5,3,4}}}}{2,5,3,4}
\end{qstest}


Funcounter = \the\value{Funcounter}


\newcommand*{\uncurryme}[2]{#1#2}
\begin{qstest}{Pair}{}
    \Expect*{\Fst{\ConsPair{1}{2}}}{1}
    \Expect*{\Snd{\ConsPair{1}{2}}}{2}
    \Expect*{\Unpair{\Pair(1,2)}}{(1,2)}
    \Expect*{\Uncurry{\uncurryme}{\Pair(1,2)}}{12}
\end{qstest}


\begin{qstest}{Zip}{}
    \Expect*{%
        \Unlist{\Map{\Unpair}{\Zip{\List{1,2,3}}{\List{a,b,c,d}}}}%
    }{(1,a),(2,b),(3,c)}
    \Expect*{%
        \Unlist{\Map{\Unpair}{\Zip{\List{1,2,3,4}}{\List{a,b,c}}}}%
    }{(1,a),(2,b),(3,c)}
\end{qstest}


\begin{qstest}{Nth}{}
    \Expect*{\Nth{3}{\List{1,2,3,4,5}}}{4}
    \Expect*{\Nth{0}{\List{1,2,3,4,5}}}{1}
\end{qstest}

%Test Length: \Length{\List{1,2,3}} = 3

\def\myeq#1#2{\TeXif{\ifnum#1=#2 }}
\newcommand*{\alwaystrue}[2]{\True}
\newcommand*{\alwaysfalse}[2]{\False}
\AssertTrue{\EqualWith{\myeq}{\List{1,2,3}}{\List{1,2,3}}}
\AssertTrue{\EqualWith{\alwaystrue}{\Nil}{\Nil}}
\AssertTrue{\EqualWith{\alwaysfalse}{\Nil}{\Nil}}
\AssertFalse{\EqualWith{\myeq}{\List{1,2}}{\List{1,2,3}}}
\AssertFalse{\EqualWith{\myeq}{\List{1,2}}{\List{1,2,3}}}
\AssertFalse{\EqualWith{\myeq}{\List{1,2,3}}{\List{1,2}}}
\AssertFalse{\EqualWith{\myeq}{\Nil}{\List{1,2}}}
\AssertFalse{\EqualWith{\myeq}{\List{1,2,3}}{\Nil}}
\AssertFalse{\EqualWith{\myeq}{\List{1,2,3}}{\List{1,2,2}}}


% Foreach test
\Foreach{\List{1,2,3}}{#1} = 123


\end{document}
