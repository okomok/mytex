\documentclass{article}
\usepackage{strd,cat,my,hask}
\usepackage[active,tightpage]{preview}



\begin{document}

% function box
\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdmid, \strdrlabel{mb},\strdframearound
        , \strdmapframe{1}{1}{
            \strdmid
            , \strdcell{k}
            , \strdmid, \strdrlabel{a}
        }, \strdframellabel{\strdlvert{\haskop{=<<}}}
        , \strdmid, \strdrlabel{ma}
        , \strdcell{\haskop{return}}
        , \strdmid, \strdrlabel{a}
    } =
    \strdgathered{
        \strdmid, \strdrlabel{mb}
        , \strdcell{k}
        , \strdmid,\strdrlabel{a}
    }
}

% lambda
\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdmid,\strdrlabel{\haskop{Int}},
        \strdframearound,
        \strdmapframe{2}{2}{
            \strdmid,%\strdrlabel{\haskop{Int}},
            \strdcell{\haskop{+}},
            \strdcap,\strdrlabelat{Left}{\haskop{Int}},\strdrlabelat{Right}{\haskop{Int}},
            \strdcellat{Left End}{x},\strdcellat{Right End}{2},
            \strdnone{\strdyhalf\strdmid}
        },\strdunfamilylabel{x},
        \strdmid,\strdrlabel{\haskop{Int}}
    } = \haskbackslash x \haskop{->} x \haskop{+} 2
}

\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdmid,\strdrlabel{?},
        \strdmapframe{1.3}{1.3}{
            \strdmid,\strdrlabel{ma},
            \strdcell{\haskop{return}},
            \strdmid,\strdrlabel{a}
        },\strdunfamilylabel{a},
        \strdmid,\strdrlabel{?}
    }
}


\end{document}
