\documentclass{article}
\usepackage{strd,cat,my,lambdax}
\usepackage[active,tightpage]{preview}

\begin{document}

% signature
\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdmid,\strdrlabel{B},\strdstartlabel{\mathcal{K}l},
        \strdidbox{1.7}{1.7}{
            \strdbranch{
                \strdmid,\strdrlabel{}
            },
            \strdtubestart,
            \strdtubemid,
            \strdtubecell{1}{k},
            \strdmid,\strdrlabel{}
        },
        \strdmid,\strdrlabel{A}
    } \\
}

% Kleisli category
\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdmid,\strdrlabel{A}
    } \ \mydefeq\ 
    \strdgathered{
        \strdmid,\strdrlabel{A},
        \strdidbox{1.7}{1.7}{
            \strdbranch{
                \strdmid,\strdrlabelat{Mid}{},
                \strdmid
            },
            \strdtubestart,
            \strdtubemid,
            \strdtubeedgebhd,
            \strdjump
        },
        \strdmid,\strdrlabel{A}
    } \\
    \myitem &
    \strdgathered{
        \strdmid,\strdrlabel{C},
        \strdidbox{1.7}{1.7}{
            \strdbranch{
                \strdmid,\strdrlabel{}
            },
            \strdtubestart,
            \strdtubemid,
            \strdtubecell{1}{l},
            \strdmid,\strdrlabel{}
        },
        \strdmid,\strdrlabel{B},
        \strdidbox{1.7}{1.7}{
            \strdbranch{
                \strdmid,\strdrlabel{}
            },
            \strdtubestart,
            \strdtubemid,
            \strdtubecell{1}{k},
            \strdmid,\strdrlabel{}
        },
        \strdmid,\strdrlabel{A}
    } \ \mydefeq \
    \strdgathered{
        \strdmid,\strdrlabel{C},
        \strdidbox{2.7}{2.7}{
            \strdbranch{
                \strdtubestart,
                \strdtubemid,\strdtubeedgehd,
                \strdbranch{
                    \strdtubemid,\strdtubecell{1}{l}
                },
                \strdtubecap{1}{1},
                \strdtubemid,\strdtubecell{2}{k}
            },
            \strdyscale{2}\strdmid,\strdmid,\strdrlabel{B},\strdmid
        },
        \strdmid,\strdrlabel{A}
    }
}


% Kleisli adjunction
\In{preview,math,aligned}{
    \myitem &
    \strdgathered{
        \strdmid,\strdrlabel{B},
        \strdcell{f},
        \strdmid,\strdrlabel{A}
    } \ \mapsto \
    \strdgathered{
        \strdmid,\strdrlabel{B},
        \strdidbox{1.7}{1.7}{
            \strdbranch{
                \strdmid,
                \strdcell{f}
            },
            \strdtubestart,
            \strdtubemid,
            \strdtubeedgebhd,
            \strdmid
        },
        \strdmid,\strdrlabel{A}
    } \\
    \myitem &
    \strdgathered{
        \strdmid,\strdrlabel{B},
        \strdidbox{1.7}{1.7}{
            \strdbranch{
                \strdmid,\strdrlabel{}
            },
            \strdtubestart,
            \strdtubemid,
            \strdtubecell{1}{k},
            \strdmid,\strdrlabel{}
        },
        \strdmid,\strdrlabel{A}
    } \ \mapsto\
    \strdgathered{
        \strdbranch{
            \strdtubestart,\strdtubebound,
            \strdtubemid,\strdtubeedgehd,
            \strdbranch{
                \strdtubemid,\strdtubecell{1}{k}
            },
            \strdtubecap{1}{1},\strdtubemid,\strdtubebound
        },
        \strdmid,\strdrlabel{B},
        \strdmid,
        \strdmid,\strdrlabel{A}
    }
}


\end{document}
